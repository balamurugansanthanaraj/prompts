
const rota = items[0].json.rota;
const today = new Date();

let selected = null;

for (const r of rota) {
  const from = new Date(r.week_start);
  const to = new Date(r.week_end);

  if (today >= from && today <= to) {
    selected = r.assignee;
    break;
  }
}

// Fallback user if no match
if (!selected) {
  selected = "default_support_user";
}

return [{ json: { assignee: selected } }];
